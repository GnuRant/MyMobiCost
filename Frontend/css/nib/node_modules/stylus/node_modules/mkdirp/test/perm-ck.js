var mkdirp=require("../"),path=require("path"),fs=require("fs"),test=require("tap").test;test("async perm",function(e){e.plan(2);var t="/tmp/"+(Math.random()*(1<<30)).toString(16);mkdirp(t,493,function(n){n?e.fail(n):path.exists(t,function(n){n?fs.stat(t,function(t,n){if(t)e.fail(t);else{e.equal(n.mode&511,493);e.ok(n.isDirectory(),"target not a directory");e.end()}}):e.fail("file not created")})})});test("async root perm",function(e){mkdirp("/tmp",493,function(n){n&&e.fail(n);e.end()});e.end()});
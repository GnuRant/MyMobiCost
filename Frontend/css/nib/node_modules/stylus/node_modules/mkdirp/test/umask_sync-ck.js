var mkdirp=require("../"),path=require("path"),fs=require("fs"),test=require("tap").test;test("umask sync modes",function(e){e.plan(2);var t=Math.floor(Math.random()*Math.pow(16,4)).toString(16),n=Math.floor(Math.random()*Math.pow(16,4)).toString(16),r=Math.floor(Math.random()*Math.pow(16,4)).toString(16),i="/tmp/"+[t,n,r].join("/");try{mkdirp.sync(i)}catch(s){e.fail(s);return e.end()}path.exists(i,function(t){t?fs.stat(i,function(t,n){if(t)e.fail(t);else{e.equal(n.mode&511,511&~process.umask());e.ok(n.isDirectory(),"target not a directory");e.end()}}):e.fail("file not created")})});
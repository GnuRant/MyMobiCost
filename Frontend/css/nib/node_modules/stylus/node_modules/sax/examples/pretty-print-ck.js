function entity(e){return e.replace('"',"&quot;")}function ontext(e){this.indent();print(e)}function print(e){process.stdout.write(e)||fstr.pause()}var sax=require("../lib/sax"),printer=sax.createStream(!1,{lowercasetags:!0,trim:!0}),fs=require("fs");printer.tabstop=2;printer.level=0;printer.indent=function(){print("\n");for(var e=this.level;e>0;e--)for(var t=this.tabstop;t>0;t--)print(" ")};printer.on("opentag",function(e){this.indent();this.level++;print("<"+e.name);for(var t in e.attributes)print(" "+t+'="'+entity(e.attributes[t])+'"');print(">")});printer.on("text",ontext);printer.on("doctype",ontext);printer.on("closetag",function(e){this.level--;this.indent();print("</"+e+">")});printer.on("cdata",function(e){this.indent();print("<![CDATA["+e+"]]>")});printer.on("comment",function(e){this.indent();print("<!--"+e+"-->")});printer.on("error",function(e){console.error(e);throw e});if(!process.argv[2])throw new Error("Please provide an xml file to prettify\nTODO: read from stdin or take a file");var xmlfile=require("path").join(process.cwd(),process.argv[2]),fstr=fs.createReadStream(xmlfile,{encoding:"utf8"});process.stdout.on("drain",function(){fstr.resume()});fstr.pipe(printer);
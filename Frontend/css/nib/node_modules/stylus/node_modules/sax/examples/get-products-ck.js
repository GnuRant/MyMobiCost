// pull out /GeneralSearchResponse/categories/category/items/product tags
// the rest we don't care about.
var sax=require("../lib/sax.js"),fs=require("fs"),path=require("path"),xmlFile=path.resolve(__dirname,"shopping.xml"),util=require("util"),http=require("http");fs.readFile(xmlFile,function(e,t){http.createServer(function(n,r){if(e)throw e;var i=t.toString("utf8"),s=sax.parser(!0),o=[],u=null,a=null;s.onclosetag=function(e){if(e==="product"){o.push(u);a=u=null;return}if(a&&a.parent){var t=a.parent;delete a.parent;a=t}};s.onopentag=function(e){if(e.name!=="product"&&!u)return;e.name==="product"&&(u=e);e.parent=a;e.children=[];e.parent&&e.parent.children.push(e);a=e};s.ontext=function(e){a&&a.children.push(e)};s.onend=function(){var e=util.inspect(o,!1,3,!0);r.writeHead(200,{"content-type":"application/json"});r.end('{"ok":true}')};s.write(i).end()}).listen(1337)});